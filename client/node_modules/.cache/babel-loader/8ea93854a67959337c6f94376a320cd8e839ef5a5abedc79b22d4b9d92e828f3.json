{"ast":null,"code":"import React, { useRef, useState, useEffect } from 'react';\nfunction _inheritsLoose(subClass, superClass) {\n  subClass.prototype = Object.create(superClass.prototype);\n  subClass.prototype.constructor = subClass;\n  _setPrototypeOf(subClass, superClass);\n}\nfunction _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n  return _setPrototypeOf(o, p);\n}\nfunction _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n  return self;\n}\nvar W3CWebSocket = require('websocket').w3cwebsocket;\nvar WebSocketNext = function WebSocketNext(props) {\n  var didMountRef = useRef(false);\n  var _useState = useState(new W3CWebSocket(props.url)),\n    ws = _useState[0],\n    setWS = _useState[1];\n  var _useState2 = useState(1),\n    attempts = _useState2[0],\n    setAttempts = _useState2[1];\n  var _useState3 = useState(props.reconnect),\n    reconnect = _useState3[0],\n    setReconnect = _useState3[1];\n  var _useState4 = useState(-1),\n    timeoutID = _useState4[0],\n    setTimeoutID = _useState4[1];\n  useEffect(function () {\n    if (!didMountRef.current) {\n      didMountRef.current = true;\n      setupWebsocket();\n    } else {\n      return function () {\n        setReconnect(false);\n        clearTimeout(timeoutID);\n        ws.close();\n      };\n    }\n  }, []);\n  var setupWebsocket = function setupWebsocket() {\n    ws.onopen = function () {\n      if (typeof props.onOpen === 'function') props.onOpen();\n    };\n    ws.onerror = function (e) {\n      if (typeof props.onError === 'function') props.onError(e);\n    };\n    ws.onmessage = function (evt) {\n      props.onMessage(evt.data);\n    };\n    ws.onclose = function (evt) {\n      if (typeof props.onClose === 'function') {\n        props.onClose(evt.code, evt.reason);\n      }\n      if (reconnect) {\n        var tid = setTimeout(function () {\n          setAttempts(attempts + 1);\n          setWS(new W3CWebSocket(props.url));\n          setupWebsocket();\n        }, props.reconnectIntervalInMilliSeconds || 3000);\n        setTimeoutID(tid);\n      }\n    };\n  };\n  return /*#__PURE__*/React.createElement(\"div\", null);\n};\nvar W3CWebSocket$1 = require('websocket').w3cwebsocket;\nvar WebSocket = /*#__PURE__*/function (_React$Component) {\n  _inheritsLoose(WebSocket, _React$Component);\n  function WebSocket(props) {\n    var _this;\n    _this = _React$Component.call(this, props) || this;\n    _this.state = {\n      ws: new W3CWebSocket$1(_this.props.url),\n      attempts: 1\n    };\n    _this.sendMessage = _this.sendMessage.bind(_assertThisInitialized(_this));\n    _this.setupWebsocket = _this.setupWebsocket.bind(_assertThisInitialized(_this));\n    return _this;\n  }\n  var _proto = WebSocket.prototype;\n  _proto.logging = function logging(logline) {\n    if (this.props.debug === true) {\n      console.log(logline);\n    }\n  };\n  _proto.generateInterval = function generateInterval(k) {\n    if (this.props.reconnectIntervalInMilliSeconds > 0) {\n      return this.props.reconnectIntervalInMilliSeconds;\n    }\n    return Math.min(30, Math.pow(2, k) - 1) * 1000;\n  };\n  _proto.setupWebsocket = function setupWebsocket() {\n    var _this2 = this;\n    var websocket = this.state.ws;\n    websocket.onopen = function () {\n      _this2.logging('Websocket connected...');\n      if (typeof _this2.props.onOpen === 'function') _this2.props.onOpen();\n    };\n    websocket.onerror = function (e) {\n      if (typeof _this2.props.onError === 'function') _this2.props.onError(e);\n    };\n    websocket.onmessage = function (evt) {\n      _this2.props.onMessage(evt.data);\n    };\n    this.shouldReconnect = this.props.reconnect;\n    websocket.onclose = function (evt) {\n      _this2.logging(\"Websocket disconnected,the reason: \" + evt.reason + \",the code: \" + evt.code);\n      if (typeof _this2.props.onClose === 'function') _this2.props.onClose(evt.code, evt.reason);\n      if (_this2.shouldReconnect) {\n        var time = _this2.generateInterval(_this2.state.attempts);\n        _this2.timeoutID = setTimeout(function () {\n          _this2.setState({\n            attempts: _this2.state.attempts + 1\n          });\n          _this2.setState({\n            ws: new W3CWebSocket$1(_this2.props.url)\n          });\n          _this2.setupWebsocket();\n        }, time);\n      }\n    };\n  };\n  _proto.componentDidMount = function componentDidMount() {\n    var childRef = this.props.childRef;\n    childRef && childRef(this);\n    this.setupWebsocket();\n  };\n  _proto.componentWillUnmount = function componentWillUnmount() {\n    var childRef = this.props.childRef;\n    childRef && childRef(undefined);\n    this.shouldReconnect = false;\n    clearTimeout(this.timeoutID);\n    var websocket = this.state.ws;\n    websocket.close();\n  };\n  _proto.sendMessage = function sendMessage(message) {\n    var websocket = this.state.ws;\n    websocket.send(message);\n  };\n  _proto.render = function render() {\n    return /*#__PURE__*/React.createElement(\"div\", null);\n  };\n  return WebSocket;\n}(React.Component);\nexport { WebSocket, WebSocketNext };","map":{"version":3,"names":["W3CWebSocket","require","w3cwebsocket","WebSocketNext","props","didMountRef","useRef","_useState","useState","url","ws","setWS","_useState2","attempts","setAttempts","_useState3","reconnect","setReconnect","_useState4","timeoutID","setTimeoutID","useEffect","current","setupWebsocket","clearTimeout","close","onopen","onOpen","onerror","e","onError","onmessage","evt","onMessage","data","onclose","onClose","code","reason","tid","setTimeout","reconnectIntervalInMilliSeconds","React","createElement","W3CWebSocket$1","WebSocket","_React$Component","_inheritsLoose","_this","call","state","sendMessage","bind","_assertThisInitialized","_proto","prototype","logging","logline","debug","console","log","generateInterval","k","Math","min","pow","_this2","websocket","shouldReconnect","time","setState","componentDidMount","childRef","componentWillUnmount","undefined","message","send","render","Component"],"sources":["/home/klums24/Development/code/phase-5/p5-final-project/client/node_modules/nextjs-websocket/src/socketNext.js","/home/klums24/Development/code/phase-5/p5-final-project/client/node_modules/nextjs-websocket/src/index.js"],"sourcesContent":["import React, { useRef, useEffect, useState } from 'react'\n\nvar W3CWebSocket = require('websocket').w3cwebsocket\n\nconst WebSocketNext = (props) => {\n  const didMountRef = useRef(false)\n  const [ws, setWS] = useState(new W3CWebSocket(props.url))\n  const [attempts, setAttempts] = useState(1)\n  const [reconnect, setReconnect] = useState(props.reconnect)\n  const [timeoutID, setTimeoutID] = useState(-1)\n\n  useEffect(() => {\n    if (!didMountRef.current) {\n      didMountRef.current = true\n      setupWebsocket()\n    } else {\n      return () => {\n        setReconnect(false)\n        clearTimeout(timeoutID)\n        ws.close()\n      }\n    }\n  }, [])\n\n  const setupWebsocket = () => {\n    ws.onopen = () => {\n      if (typeof props.onOpen === 'function') props.onOpen()\n    }\n    ws.onerror = (e) => {\n      if (typeof props.onError === 'function') props.onError(e)\n    }\n    ws.onmessage = (evt) => {\n      props.onMessage(evt.data)\n    }\n    ws.onclose = (evt) => {\n      if (typeof props.onClose === 'function') {\n        props.onClose(evt.code, evt.reason)\n      }\n      if (reconnect) {\n        const tid = setTimeout(() => {\n          setAttempts(attempts + 1)\n          setWS(new W3CWebSocket(props.url))\n          setupWebsocket()\n        }, props.reconnectIntervalInMilliSeconds || 3000)\n        setTimeoutID(tid)\n      }\n    }\n  }\n\n  return <div />\n}\n\nexport { WebSocketNext }\n","import React from 'react'\n\nimport { WebSocketNext } from './socketNext'\n\nvar W3CWebSocket = require('websocket').w3cwebsocket\n\nclass WebSocket extends React.Component {\n  constructor(props) {\n    super(props)\n    this.state = {\n      ws: new W3CWebSocket(this.props.url),\n      attempts: 1\n    }\n    this.sendMessage = this.sendMessage.bind(this)\n    this.setupWebsocket = this.setupWebsocket.bind(this)\n  }\n\n  logging(logline) {\n    if (this.props.debug === true) {\n      console.log(logline)\n    }\n  }\n\n  generateInterval(k) {\n    if (this.props.reconnectIntervalInMilliSeconds > 0) {\n      return this.props.reconnectIntervalInMilliSeconds\n    }\n    return Math.min(30, Math.pow(2, k) - 1) * 1000\n  }\n\n  setupWebsocket() {\n    let websocket = this.state.ws\n\n    websocket.onopen = () => {\n      this.logging('Websocket connected...')\n      if (typeof this.props.onOpen === 'function') this.props.onOpen()\n    }\n\n    websocket.onerror = (e) => {\n      if (typeof this.props.onError === 'function') this.props.onError(e)\n    }\n\n    websocket.onmessage = (evt) => {\n      this.props.onMessage(evt.data)\n    }\n\n    this.shouldReconnect = this.props.reconnect\n    websocket.onclose = (evt) => {\n      this.logging(\n        `Websocket disconnected,the reason: ${evt.reason},the code: ${evt.code}`\n      )\n      if (typeof this.props.onClose === 'function')\n        this.props.onClose(evt.code, evt.reason)\n      if (this.shouldReconnect) {\n        let time = this.generateInterval(this.state.attempts)\n        this.timeoutID = setTimeout(() => {\n          this.setState({ attempts: this.state.attempts + 1 })\n          this.setState({ ws: new W3CWebSocket(this.props.url) })\n          this.setupWebsocket()\n        }, time)\n      }\n    }\n  }\n\n  componentDidMount() {\n    const { childRef } = this.props\n    childRef && childRef(this)\n\n    this.setupWebsocket()\n  }\n\n  componentWillUnmount() {\n    const { childRef } = this.props\n    childRef && childRef(undefined)\n\n    this.shouldReconnect = false\n    clearTimeout(this.timeoutID)\n\n    let websocket = this.state.ws\n    websocket.close()\n  }\n\n  sendMessage(message) {\n    let websocket = this.state.ws\n    websocket.send(message)\n  }\n\n  render() {\n    return <div></div>\n  }\n}\n\nexport { WebSocket, WebSocketNext }\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}